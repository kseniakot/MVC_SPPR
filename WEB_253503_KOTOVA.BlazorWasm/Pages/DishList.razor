@using WEB_253503_KOTOVA.Domain.Entities
@inject IDataService DataService

<AuthorizeView>
    <Authorized>
        @if (DataService.Dishes == null || DataService.Dishes.Count == 0)
        {
            <p>No dishes available.</p>
        }
        else
        {
            <table class="table table-striped table-hover">
                <thead class="table-dark">
                    <tr>
                        <th>Name</th>
                        <th>Description</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var dish in DataService.Dishes)
                    {
                        <tr>
                            <td>@dish.Name</td>
                            <td>@dish.Description</td>
                            <td>    
                                <button class="btn btn-primary" @onclick="() => OnDishSelected.InvokeAsync(dish.Id)">
                                    Подробнее
                                </button>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        }
    </Authorized>
    <NotAuthorized>
        <p class="text-warning">You are not authorized to view this page. Please log in.</p>
    </NotAuthorized>
</AuthorizeView>

@code {
    [Parameter] public EventCallback<int> OnDishSelected { get; set; }

   

    protected override void OnInitialized()
    {
        DataService.DataLoaded += StateHasChanged;
    }

    public void Dispose()
    {
        DataService.DataLoaded -= StateHasChanged;
    }

}
